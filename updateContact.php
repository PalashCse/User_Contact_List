<?php     /*start database connection and session*/	include 'config.php';	session_start();	/*decrypt user id*/	$tid=$_GET['id'];	$uid=$_SESSION['st_id'];	include('encrypt_decrypt/en_de_crypt.php');	$id=decrypt($uid);	$ttid=decrypt($tid);	/*restrict illegal user*/	include('illegal_access/check_illegal.php');	include('func_query/query.php');?><!--update only for user--><?php include('header/header.php');?>	<div class="wrapper">		<div class="container">			<div class="contact_main col-md-offset-2 col-md-8">				<div class="col-md-12 col-sm-12  contact_header text-center">					<h2>Edit Contact</h2>                    <!--menu section for user-->					<div class="menu col-md-offset-7 col-md-5 text-right">						<ul>							<li><a href ="userprofile.php<?php $_SESSION['st_id']=encrypt($id);?>">Home</a></li>							<li><a href="usercontactList.php<?php $_SESSION['st_id']=encrypt($id);?>">View</a></li>						</ul>					</div>				</div>            <?php				$firststname_old = $lastname_old=$address_old = $email_old= $contact_date_old=$phone_old=$image_old=$st_contact_id_old="";				/*php code for take existing field value*/				$result=indv_contact_Retrieve($db,$ttid);				while($row = mysqli_fetch_array($result))				{					$st_contact_id_old=$row['st_contact_id'];					$firststname_old=$row['firststname'];					$lastname_old=$row['lastname'];					$address_old=$row['address'];					$email_old=$row['email'];					$contact_date_old=$row['contact_date'];					$phone_old=$row['phone'];					$image_old=$row['image_name'];				}			?>				<?php               /*input field validation*/				$imgerror ="";				$err1= $err2= $err3=$err4=$err5=$err6="" ;				$errors = array();					if(isset($_POST['send']))				{					$firstname = $_POST['f_name'];					$lastname = $_POST['l_name'];					$address = $_POST['u_address'];						$email = $_POST['u_email'];					$contact_date = $_POST['u_contact_date'];					$phone = $_POST['u_phone'];										/*Form validation*/					include('validation/valid_check.php');					$err1=check_Fname($firstname);					$err2=check_Fname($lastname);					$err3=check_Address($address);					$err4=check_Email($email);					$err5=check_Condate( $contact_date);					$err6=check_Phone($phone);					if(empty($err1)&&empty($err2)&&empty($err3)&&empty($err4)&&empty($err5)&&empty($err6))					{                    /*php code for file(image) upload */					$file_name=$_FILES["image_file"]["name"];					$file_ext = substr( $file_name, strripos($file_name, '.') );                    /*verify img exten in .jpg & .png fornat*/														if(!empty($file_name))						{							if( ($file_ext  == ".png") || ($file_ext == ".jpg"))							{								$target_path1= 'upload/'.$file_name;									$target_path=move_uploaded_file($_FILES["image_file"]["tmp_name"],'upload/'.$file_name);								$result=user_data_update($db,$ttid,$firstname,$lastname,$address,$email,$contact_date,$phone,$target_path1);								if($result)								{								    header('Location:viewcontact.php');								}								else								{									?>										  <script>											alert("Fail to update data");										  </script>									<?php								}							}							else							{								$imgerror= "your uploaded file must be in png or jpg format ";							}						}								$target_path1= 'upload/'.$file_name;									$target_path=move_uploaded_file($_FILES["image_file"]["tmp_name"],'upload/'.$file_name);								$result= user_data_update_wi($db,$ttid,$firstname,$lastname,$address,$email,$contact_date,$phone);								if($result)								{								    header('Location:viewcontact.php');								}								else								{									?>										  <script>											alert("Fail to update data");										  </script>									<?php								}													}					}			?>				              <!-- html input form for user update-->				<form class = "form-horizontal" method="post" action="" enctype="multipart/form-data">  <!--update.php -->                    <!--user first name-->									<div class="form-group  ">						<label class=" col-md-2 col-md-offset-2 text-right" for="usrFN" > First Name: </label>						<div class="col-md-5  ">							<input type = "text" class = "form-control " id="usrFN" value="<?php echo $firststname_old; ?>" name="f_name" required>							<p class="error"><?php echo $err1;?></p>						</div>					</div>                    <!--user last name-->							<div class="form-group">						<label for="usrLN" class="col-md-2 col-md-offset-2 text-right" >Last Name: </label>						<div class="col-md-5 ">							<input type = "text" class = "form-control " id="usrLN" value="<?php echo $lastname_old; ?>" name="l_name" required>							<p class="error"><?php echo $err2;?></p>						</div>					</div>	                   <!--user addr-->							<div class="form-group">						<label for="Address" class="col-md-2 col-md-offset-2 text-right" >Address: </label>						<div class="col-md-5 ">							<input type = "text" class = "form-control col-md-6" id="Address" value="<?php echo $address_old; ?>" name="u_address" >						<p class="error"><?php echo $err3;?></p>						</div>					</div>                    <!--user contact email-->							<div class="form-group">						<label for="EMAIL" class="col-md-2 col-md-offset-2 text-right">Email: </label>						<div class="col-md-5 ">							<input type = "text" class = "form-control col-md-6 datepicker" id="EMAIL" value="<?php echo $email_old; ?>" name="u_email" required>							<p class="error"><?php echo $err4;?></p>						</div>					</div>                   <!-- Date-->								<div class="form-group">						<label for="DATE" class="col-md-2 col-md-offset-2 text-right">Date: </label>						<div class="col-md-5 ">							<input type = "text" class = "form-control col-md-6" id="DATE" value="<?php echo $contact_date_old; ?>" name="u_contact_date" required>							<p class="error"><?php echo $err5;?></p>						</div>					</div>                    <!--user Phone-->										<div class="form-group">						<label for="phn" class="col-md-2 col-md-offset-2 text-right">Phone: </label>						<div class="col-md-5 ">							<input type = "text" class = "form-control col-md-6" id="phn" value="<?php echo $phone_old; ?>" name="u_phone" required>							<p class="error"><?php echo $err6;?></p>						</div>					</div>	                    <!--user image-->							<div class="form-group">						<label class="col-md-2 col-md-offset-2 text-right col-md-6">Image: </label>						<input type="file" name="image_file">						<p class="error col-md-offset-1 "><?php echo $imgerror;?></p>						<p class="col-md-offset-2 "><?php echo $image_old;?></p>					</div>                    <!--submit updated info-->												<div class="form-group" > 						<div class="col-md-offset-1 text-center">							<input class="btn btn-primary" type="submit" value="Update" name="send">						</div>					</div>				</form>			</div>					</div>	</div></body></html>